@using Shared.Models.Areas.evolDP
@using Shared.ViewModels.Areas.evolDP
@using Microsoft.AspNetCore.Mvc.Localization
@using Shared.ViewModels.Areas.Reports
@inject IViewLocalizer localizer
@model DependentProductionViewModel

<div class="d-flex justify-content-center">
    <div class="spinner-border" role="status" id="myLoader" style="display:none">
        <span class="sr-only">Loading...</span>
    </div>
</div>
@if (Model == null)
{
    <div id="ResultPage">
        <h3 class="display-4 text-center">@localizer["NoModelData"]</h3>
    </div>
}
else
{
    <div id="TitlePage">
        <h1>@localizer["JobsControl"]</h1>
    </div>

    <div class="my-3">
        <table class="table table-sm table-hover">
            <thead id="bootstrap-overrides" class="sticky-header">
                <tr class="collapsible active">
                    <th class="borders" rowspan="2" style="text-align:center;vertical-align:middle"></th>
                    <th colspan="7" scope="rowgroup" style="text-align:center;vertical-align:middle">
                        @localizer["DependentPrints"]
                    </th>
                </tr>
                <tr>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">
                        @localizer["RunsDate"] </br>
                        @localizer["BusinessName"]
                    </th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">@localizer["ExpType"]</th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">@localizer["ExpCompany"]</th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">@localizer["PrintType"]</th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">@localizer["Files"]</th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">Docs</th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">@localizer["Prints"]</th>
                </tr>
            </thead>
            <tbody id="bootstrap-overrides">
                @{
                    int FilesTotalP = 0;
                    int DocsTotalP = 0;
                    int PrintsTotalP = 0;
                }
                @foreach (DependentPrintsInfo print in Model.DependentPrintProduction)
                {
                    <tr>
                        @{
                            DateTime rDate;
                            string runDate = print.RunDate.ToString();
                            if (DateTime.TryParseExact(print.RunDate.ToString(), "yyyyMMdd",
                            System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out rDate))
                                runDate = rDate.ToShortDateString();
                            //string RunName = runDate + " [" + retention.RunSequence + "]";
                        }

                        <td class="borders" style="text-align:center;vertical-align:middle"</td>
                        <td>
                            @print.DocTypeLayout


                        </td>
                        <td>@print.ExpType</td>
                        <td>@print.ExpCompany</td>
                        <td>@print.PrintType</td>
                        <td>@print.Files</td>
                        @{
                            FilesTotalP += print.Files;
                        }
                        <td>@print.Docs</td>
                        @{
                            DocsTotalP += print.Docs;
                        }
                        <td>@print.Prints</td>
                        @{
                            PrintsTotalP += print.Prints;
                        }
                    </tr>
                }
                <tr class="table-end">
                    <td></td>
                    <td class="table-end-data">Total</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td class="table-end-data">@FilesTotalP</td>
                    <td class="table-end-data">@DocsTotalP</td>
                    <td class="table-end-data">@PrintsTotalP</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="my-3">
        <table class="table table-sm table-hover">
            <thead id="bootstrap-overrides" class="sticky-header">
                <tr class="collapsible active">
                    <th class="borders" rowspan="2" style="text-align:center;vertical-align:middle"></th>
                    <th colspan="8" scope="rowgroup" style="text-align:center;vertical-align:middle">
                        @localizer["DependentEnvs"]
                    </th>
                </tr>
                <tr>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">
                        @localizer["RunsDate"] </br>
                        @localizer["BusinessName"]
                    </th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">@localizer["ExpType"]</th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">@localizer["ExpCompany"]</th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">@localizer["EnvFormat"]</th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">@localizer["EnvType"]</th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">@localizer["Files"]</th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">Docs</th>
                    <th rowspan="1" scope="colgroup" style="text-align:center;vertical-align:middle">@localizer["Envs"]</th>
                </tr>
            </thead>
            <tbody id="bootstrap-overrides">
                @{
                    int FilesTotalE = 0;
                    int DocsTotalE = 0;
                    int EnvsTotalE = 0;
                }
                @foreach (DependentEnvsInfo fullfill in Model.DependentEnvProduction)
                {
                    <tr>
                        @{
                            DateTime rDate;
                            string runDate = fullfill.RunDate.ToString();
                            if (DateTime.TryParseExact(fullfill.RunDate.ToString(), "yyyyMMdd",
                            System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out rDate))
                                runDate = rDate.ToShortDateString();
                            //string RunName = runDate + " [" + retention.RunSequence + "]";
                        }

                        <td class="borders" style="text-align:center;vertical-align:middle"</td>
                        <td>
                            @fullfill.DocTypeLayout


                        </td>
                        <td>@fullfill.ExpType</td>
                        <td>@fullfill.ExpCompany</td>
                        <td>@fullfill.EnvFormat</td>
                        <td>@fullfill.EnvType</td>
                        <td>@fullfill.Files</td>
                        @{
                            FilesTotalP += fullfill.Files;
                        }
                        <td>@fullfill.Docs</td>
                        @{
                            DocsTotalP += fullfill.Docs;
                        }
                        <td>@fullfill.Envs</td>
                        @{
                            EnvsTotalE += fullfill.Envs;
                        }
                    </tr>
                }
                <tr class="table-end">
                    <td></td>
                    <td class="table-end-data">Total</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td class="table-end-data">@FilesTotalP</td>
                    <td class="table-end-data">@DocsTotalP</td>
                    <td class="table-end-data">@EnvsTotalE</td>
                </tr>
            </tbody>
        </table>
    </div>
}